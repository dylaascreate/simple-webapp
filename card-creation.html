<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invitation Card Generator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load html2canvas library for image generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Load Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Playfair+Display:wght@700&family=Poppins:wght@700&display=swap" rel="stylesheet">
    
    <style>
        /* Use Inter as the default sans-serif font */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Specific fonts for card styles */
        .font-playfair {
            font-family: 'Playfair Display', serif;
        }
        .font-poppins {
            font-family: 'Poppins', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen p-4 md:p-8 transition-colors duration-300">

    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-blue-600 dark:text-blue-400">Invitation Card Generator</h1>
            <p class="text-lg text-gray-600 dark:text-gray-300 mt-2">Create a beautiful invitation for your event in seconds.</p>
        </header>

        <!-- Main Content: Form & Preview -->
        <div class="flex flex-col lg:flex-row gap-8">

            <!-- 1. Controls Panel (Form) -->
            <div class="w-full lg:w-1/2 bg-white dark:bg-gray-800 p-6 md:p-8 rounded-2xl shadow-lg">
                <form id="card-form" class="space-y-6">
                    
                    <!-- Event Type -->
                    <div>
                        <label for="event-type" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2">1. Select Event Type</label>
                        <select id="event-type" name="event-type" class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="wedding">Wedding</option>
                            <option value="birthday">Birthday</option>
                            <option value="baby-shower">Baby Shower</option>
                            <option value="graduation">Graduation</option>
                            <option value="party">General Party</option>
                        </select>
                    </div>

                    <!-- Event Title -->
                    <div>
                        <label for="event-title" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2">2. Event Title</label>
                        <input type="text" id="event-title" name="event-title" class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., Sarah & Tom's Wedding">
                    </div>

                    <!-- Wishes / Message -->
                    <div>
                        <label for="event-message" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2">3. Wishes / Message</label>
                        <textarea id="event-message" name="event-message" rows="4" class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., Please join us to celebrate..."></textarea>
                    </div>

                    <!-- Date & Time -->
                    <div class="flex flex-col sm:flex-row gap-4">
                        <div class="w-full sm:w-1/2">
                            <label for="event-date" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2">4. Date</label>
                            <input type="date" id="event-date" name="event-date" class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="w-full sm:w-1/2">
                            <label for="event-time" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2">5. Time</label>
                            <input type="time" id="event-time" name="event-time" class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>

                    <!-- Location -->
                    <div>
                        <label for="event-location" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2">6. Location / Venue</label>
                        <input type="text" id="event-location" name="event-location" class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., The Grand Oak, 123 Forest Ln">
                    </div>
                    
                    <!-- RSVP -->
                    <div>
                        <label for="event-rsvp" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2">7. RSVP Details</label>
                        <input type="text" id="event-rsvp" name="event-rsvp" class="w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., RSVP to Jane at 555-1234 by Nov 30">
                    </div>

                </form>
                
                <!-- Download Button -->
                <div class="mt-8">
                    <button type="button" id="download-btn" class="w-full px-6 py-3 bg-green-600 text-white font-bold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-all duration-300 flex items-center justify-center gap-2">
                        <!-- Download Icon SVG -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 9.293a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                        Download as Image
                    </button>
                </div>
            </div>

            <!-- 2. Preview Panel -->
            <div class="w-full lg:w-1/2 flex items-center justify-center p-6">
                <div id="card-preview" class="w-full max-w-lg aspect-[5/7] rounded-2xl shadow-2xl overflow-hidden transition-all duration-500 ease-in-out">
                    <!-- Card Image Header -->
                    <div id="card-image" class="w-full h-1/3 bg-cover bg-center transition-all duration-500" style="background-image: url('https://placehold.co/600x400/FFF1F2/EC4899?text=Welcome!');">
                    </div>
                    
                    <!-- Card Content -->
                    <div id="card-content-wrapper" class="h-2/3 p-6 md:p-8 flex flex-col justify-center text-center transition-colors duration-500">
                        <h2 id="card-title" class="text-3xl md:text-4xl font-bold mb-4 transition-all duration-500">Event Title</h2>
                        <p id="card-message" class="text-base md:text-lg mb-6">You're invited to celebrate with us!</p>
                        
                        <div class="border-t border-b py-4 my-4 space-y-2 transition-colors duration-500" id="card-details-border">
                            <p id="card-date-time" class="font-semibold text-base md:text-lg"></p>
                            <p id="card-location" class="text-base md:text-lg"></p>
                        </div>
                        
                        <p id="card-rsvp" class="text-sm md:text-base mt-4"></p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Get all form elements
            const form = document.getElementById('card-form');
            const eventType = document.getElementById('event-type');
            
            // Get all card preview elements
            const cardPreview = document.getElementById('card-preview');
            const cardImage = document.getElementById('card-image');
            const cardContentWrapper = document.getElementById('card-content-wrapper');
            const cardTitle = document.getElementById('card-title');
            const cardMessage = document.getElementById('card-message');
            const cardDateTime = document.getElementById('card-date-time');
            const cardLocation = document.getElementById('card-location');
            const cardRsvp = document.getElementById('card-rsvp');
            const cardDetailsBorder = document.getElementById('card-details-border');

            // Function to update the card preview
            function updatePreview() {
                // 1. Get all current values from the form
                const type = document.getElementById('event-type').value;
                const title = document.getElementById('event-title').value;
                const message = document.getElementById('event-message').value;
                const date = document.getElementById('event-date').value;
                const time = document.getElementById('event-time').value;
                const location = document.getElementById('event-location').value;
                const rsvp = document.getElementById('event-rsvp').value;

                // 2. Update card text content
                cardTitle.innerText = title || 'Event Title';
                cardMessage.innerText = message || 'You\'re invited to celebrate with us!';
                
                let dateString = '';
                if (date) {
                    try {
                        const dateObj = new Date(date + 'T00:00:00'); // Fix for time zone issues
                        dateString = dateObj.toLocaleDateString(undefined, { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                    } catch (e) {
                        dateString = date; // Fallback
                    }
                }
                
                let timeString = '';
                if (time) {
                     try {
                        const [hours, minutes] = time.split(':');
                        const timeObj = new Date();
                        timeObj.setHours(hours, minutes, 0);
                        timeString = timeObj.toLocaleTimeString(undefined, { hour: 'numeric', minute: '2-digit', hour12: true });
                    } catch (e) {
                        timeString = time; // Fallback
                    }
                }

                if (dateString || timeString) {
                    cardDateTime.innerText = `${dateString}${timeString ? ' at ' + timeString : ''}`;
                } else {
                    cardDateTime.innerText = 'Date & Time Here';
                }

                cardLocation.innerText = location || 'Location Here';
                cardRsvp.innerText = rsvp || 'RSVP Details';

                // 3. Update card design based on event type
                // Reset classes to a base state before applying new ones
                cardContentWrapper.className = 'h-2/3 p-6 md:p-8 flex flex-col justify-center text-center transition-colors duration-500';
                cardTitle.className = 'text-3xl md:text-4xl font-bold mb-4 transition-all duration-500';
                cardDetailsBorder.className = 'border-t border-b py-4 my-4 space-y-2 transition-colors duration-500';

                switch (type) {
                    case 'wedding':
                        cardContentWrapper.classList.add('bg-white', 'text-gray-800');
                        cardTitle.classList.add('font-playfair', 'text-gray-700');
                        cardDetailsBorder.classList.add('border-gray-200');
                        cardImage.style.backgroundImage = "url('https://placehold.co/600x400/FDFBF6/7B6B53?text=Wedding')";
                        break;
                        
                    case 'birthday':
                        cardContentWrapper.classList.add('bg-blue-600', 'text-white');
                        cardTitle.classList.add('font-poppins', 'uppercase', 'tracking-wide');
                        cardDetailsBorder.classList.add('border-blue-400');
                        cardImage.style.backgroundImage = "url('https://placehold.co/600x400/3B82F6/FFFFFF?text=Birthday+Bash!')";
                        break;
                        
                    case 'baby-shower':
                        cardContentWrapper.classList.add('bg-pink-50', 'text-pink-800');
                        cardTitle.classList.add('font-playfair', 'text-pink-700');
                        cardDetailsBorder.classList.add('border-pink-200');
                        cardImage.style.backgroundImage = "url('https://placehold.co/600x400/FDF2F8/DB2777?text=Oh+Baby!')";
                        break;
                        
                    case 'graduation':
                        cardContentWrapper.classList.add('bg-gray-900', 'text-white');
                        cardTitle.classList.add('font-playfair', 'uppercase', 'text-yellow-400');
                        cardDetailsBorder.classList.add('border-gray-600');
                        cardImage.style.backgroundImage = "url('https://placehold.co/600x400/111827/FBBF24?text=Congrats+Grad!')";
                        break;
                        
                    case 'party':
                    default:
                        cardContentWrapper.classList.add('bg-purple-700', 'text-white');
                        cardTitle.classList.add('font-poppins', 'uppercase');
                        cardDetailsBorder.classList.add('border-purple-500');
                        cardImage.style.backgroundImage = "url('https://placehold.co/600x400/5B21B6/FFFFFF?text=Let%27s+Party!')";
                        break;
                }
            }

            // Add event listener to the form to update on any input change
            form.addEventListener('input', updatePreview);

            // Add logic for the download button
            const downloadBtn = document.getElementById('download-btn');
            const downloadBtnText = downloadBtn.querySelector('span');
            
            downloadBtn.addEventListener('click', () => {
                const cardElement = document.getElementById('card-preview');
                const originalBtnContent = downloadBtn.innerHTML;

                // Show loading state
                downloadBtn.innerHTML = 'Generating...';
                downloadBtn.disabled = true;

                html2canvas(cardElement, {
                    useCORS: true, // Allows fetching cross-origin images (like from placehold.co)
                    allowTaint: false,
                    scale: 2 // Render at 2x resolution for better quality
                }).then(canvas => {
                    // Convert canvas to image data URL
                    const dataUrl = canvas.toDataURL('image/png');
                    
                    // Create a temporary link to trigger the download
                    const link = document.createElement('a');
                    link.href = dataUrl;
                    link.download = 'invitation.png'; // Set the filename
                    
                    // Trigger the download
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);

                    // Restore button state
                    downloadBtn.innerHTML = originalBtnContent;
                    downloadBtn.disabled = false;
                    
                }).catch(err => {
                    console.error('Error generating image:', err);
                    // Restore button state on error
                    downloadBtn.innerHTML = originalBtnContent;
                    downloadBtn.disabled = false;
                    // You could show a custom error message to the user here
                });
            });

            // Initial call to set the default card state
            updatePreview();
        });
    </script>
</body>
</html>