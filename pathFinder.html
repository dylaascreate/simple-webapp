<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PathFinder: Career & Skill Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        .slide-up { animation: slideUp 0.5s ease-out forwards; }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-slate-900 text-white p-6 shadow-lg z-10">
        <div class="max-w-6xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3 cursor-pointer" onclick="app.navigate('home')">
                <i class="ph-fill ph-compass-tool text-teal-400 text-3xl"></i>
                <div>
                    <h1 class="text-2xl font-bold tracking-tight">PathFinder</h1>
                    <p class="text-slate-400 text-sm">Career Guidance System</p>
                </div>
            </div>
            <button id="resetBtn" onclick="app.navigate('home')" class="hidden md:flex items-center gap-2 text-sm text-slate-300 hover:text-white transition-colors">
                <i class="ph ph-house"></i> Home
            </button>
        </div>
    </header>

    <!-- Main Content Area -->
    <main id="mainContainer" class="flex-grow max-w-6xl w-full mx-auto p-6 relative">
        
        <!-- VIEW 1: HOME / MODE SELECTION -->
        <div id="view-home" class="fade-in max-w-4xl mx-auto mt-10">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-800 mb-4">How would you like to explore?</h2>
                <p class="text-slate-500 text-lg">Choose a path to discover your potential.</p>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <!-- Card 1: Skill -> Career -->
                <div onclick="app.navigate('skill-to-career')" class="group bg-white p-8 rounded-2xl shadow-sm border border-slate-200 hover:border-teal-500 hover:shadow-xl cursor-pointer transition-all transform hover:-translate-y-1">
                    <div class="w-16 h-16 bg-teal-50 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-teal-100 transition-colors">
                        <i class="ph-fill ph-user-list text-teal-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-800 mb-2">I have Skills...</h3>
                    <p class="text-slate-500 mb-4">Enter your current skills (e.g., Python, Communication) and let us suggest suitable careers.</p>
                    <span class="text-teal-600 font-semibold flex items-center gap-1 group-hover:gap-2 transition-all">
                        Find Careers <i class="ph-bold ph-arrow-right"></i>
                    </span>
                </div>

                <!-- Card 2: Career -> Skill -->
                <div onclick="app.navigate('career-to-skill')" class="group bg-white p-8 rounded-2xl shadow-sm border border-slate-200 hover:border-indigo-500 hover:shadow-xl cursor-pointer transition-all transform hover:-translate-y-1">
                    <div class="w-16 h-16 bg-indigo-50 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-indigo-100 transition-colors">
                        <i class="ph-fill ph-graduation-cap text-indigo-600 text-3xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-800 mb-2">I want a Career...</h3>
                    <p class="text-slate-500 mb-4">Choose a target job role (e.g., Data Scientist) and see exactly what skills you need to learn.</p>
                    <span class="text-indigo-600 font-semibold flex items-center gap-1 group-hover:gap-2 transition-all">
                        Find Skills <i class="ph-bold ph-arrow-right"></i>
                    </span>
                </div>
            </div>
        </div>

        <!-- VIEW 2: SKILL TO CAREER (Reverse Search) -->
        <div id="view-skill-to-career" class="hidden slide-up">
            <div class="flex items-center gap-2 mb-6 text-slate-500 cursor-pointer hover:text-slate-800" onclick="app.navigate('home')">
                <i class="ph-bold ph-arrow-left"></i> Back to Home
            </div>

            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Left: Profile Builder -->
                <div class="lg:col-span-1 bg-white p-6 rounded-2xl shadow-sm border border-slate-200 h-fit">
                    <h2 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                        <i class="ph-fill ph-stack text-teal-600"></i> My Skills
                    </h2>
                    
                    <!-- Search Input -->
                    <div class="relative mb-4">
                        <i class="ph ph-magnifying-glass absolute left-3 top-3 text-slate-400"></i>
                        <input type="text" id="skillInput" placeholder="Add a skill (e.g. Java)..." 
                               class="w-full pl-10 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <div id="skillSuggestions" class="absolute z-20 w-full bg-white border border-slate-200 mt-1 rounded-lg shadow-lg hidden max-h-48 overflow-y-auto"></div>
                    </div>

                    <!-- Selected Skills List -->
                    <div id="selectedSkillsList" class="flex flex-wrap gap-2 mb-6 min-h-[50px]">
                        <span class="text-sm text-slate-400 italic" id="emptySkillsMsg">No skills added yet.</span>
                    </div>

                    <button onclick="app.calculateRecommendations()" class="w-full bg-teal-600 text-white font-bold py-3 rounded-xl hover:bg-teal-700 transition-colors shadow-md flex justify-center items-center gap-2">
                        <i class="ph-bold ph-magic-wand"></i> Find Careers
                    </button>
                </div>

                <!-- Right: Results -->
                <div class="lg:col-span-2">
                    <div id="recommendationResults">
                        <!-- Initial State -->
                        <div class="bg-slate-100 border border-dashed border-slate-300 rounded-2xl p-12 text-center h-full flex flex-col items-center justify-center">
                            <i class="ph-duotone ph-chart-bar text-slate-400 text-5xl mb-4"></i>
                            <h3 class="text-lg font-semibold text-slate-600">Ready to analyze</h3>
                            <p class="text-slate-500">Add your skills on the left to see career matches.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VIEW 3: CAREER TO SKILL (Forward Search) -->
        <div id="view-career-to-skill" class="hidden slide-up">
            <div class="flex items-center gap-2 mb-6 text-slate-500 cursor-pointer hover:text-slate-800" onclick="app.navigate('home')">
                <i class="ph-bold ph-arrow-left"></i> Back to Home
            </div>

            <div class="max-w-4xl mx-auto">
                <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 mb-8">
                    <h2 class="text-2xl font-bold text-slate-800 mb-2">Explore Career Requirements</h2>
                    <p class="text-slate-500 mb-6">Select a job role to view the industry-standard skill requirements.</p>

                    <!-- Career Select -->
                    <div class="relative">
                        <select id="careerSelect" onchange="app.showCareerDetails()" class="w-full p-4 bg-indigo-50 border border-indigo-100 rounded-xl text-lg font-medium text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer appearance-none">
                            <option value="" disabled selected>Select a Career Path...</option>
                            <!-- Populated via JS -->
                        </select>
                        <i class="ph-bold ph-caret-down absolute right-4 top-5 text-indigo-400 pointer-events-none"></i>
                    </div>
                </div>

                <!-- Career Detail View -->
                <div id="careerDetailView" class="hidden animate-fade-in">
                    <!-- Dynamic Content inserted here -->
                </div>
            </div>
        </div>

    </main>

    <!-- JS Logic -->
    <script>
        // --- DATA SOURCE: STRICTLY MAPPED FROM skills_mapping_data.csv (All 10 Roles) ---
        const CAREER_DB = {
            "Full-Stack Developer": {
                description: "Develops both client-side and server-side software, managing the entire stack.",
                skills: { 
                    "HTML": 0.95, "CSS": 0.95, "JavaScript": 0.95, "React": 0.7, "Vue": 0.6, "Angular": 0.5, 
                    "Express.js": 0.75, "Django": 0.65, "Flask": 0.6, "SQL": 0.9, "MongoDB": 0.7, 
                    "PostgreSQL": 0.75, "Git": 0.95, "GitHub": 0.9, "Docker": 0.6, "Kubernetes": 0.3, 
                    "AWS": 0.5, "Azure": 0.4, "Google Cloud": 0.4, "APIs": 0.8, "REST": 0.8, 
                    "GraphQL": 0.4, "Testing": 0.6, "CI/CD": 0.5 
                }
            },
            "Frontend Engineer": {
                description: "Specializes in building the user interface and experience of web applications.",
                skills: { 
                    "HTML": 0.99, "CSS": 0.99, "JavaScript": 0.99, "React": 0.95, "Vue": 0.9, 
                    "Angular": 0.85, "Bootstrap": 0.85, "Tailwind CSS": 0.8, "Next.js": 0.7,
                    "TypeScript": 0.85, "Web Performance": 0.8, "Accessibility": 0.8, "Figma": 0.7
                }
            },
            "Backend Engineer": {
                description: "Focuses on server-side logic, databases, and application architecture.",
                skills: {
                    "Python": 0.9, "Java": 0.95, "Node.js": 0.9, "Spring Boot": 0.85, "Express.js": 0.8,
                    "Django": 0.8, "Flask": 0.75, "SQL": 0.95, "MySQL": 0.9, "PostgreSQL": 0.9,
                    "MongoDB": 0.85, "Redis": 0.7, "APIs": 0.95, "REST": 0.95, "GraphQL": 0.8,
                    "Microservices": 0.9, "System Design": 0.85, "Docker": 0.8, "AWS": 0.75
                }
            },
            "Data Engineer": {
                description: "Builds and maintains the infrastructure and pipelines for data generation.",
                skills: {
                    "Python": 0.95, "SQL": 0.98, "ETL": 0.95, "Data Warehousing": 0.9, "BigQuery": 0.85,
                    "Snowflake": 0.85, "Redshift": 0.85, "Spark": 0.9, "Kafka": 0.85, "Airflow": 0.9,
                    "AWS": 0.85, "Google Cloud": 0.8, "Linux": 0.7, "Docker": 0.7, "System Design": 0.75
                }
            },
            "DevOps Engineer": {
                description: "Unifies development and operations to shorten development cycles.",
                skills: {
                    "Linux": 0.95, "Docker": 0.95, "Kubernetes": 0.95, "Jenkins": 0.9, "GitHub Actions": 0.85,
                    "CI/CD": 0.98, "Terraform": 0.95, "AWS": 0.9, "Azure": 0.85, "Google Cloud": 0.85,
                    "Git": 0.9, "Python": 0.75, "System Design": 0.8, "Ansible": 0.85
                }
            },
            "Mobile Developer": {
                description: "Develops applications for mobile devices (iOS and Android).",
                skills: {
                    "JavaScript": 0.9, "TypeScript": 0.85, "React": 0.95, "Java": 0.8, 
                    "APIs": 0.9, "REST": 0.85, "Git": 0.85, "Testing": 0.75, "UI/UX": 0.7
                }
            },
            "AI/ML Engineer": {
                description: "Builds AI models using machine learning algorithms and neural networks.",
                skills: {
                    "Python": 0.99, "R": 0.7, "Pandas": 0.95, "NumPy": 0.95, "Data Analysis": 0.9,
                    "Statistics": 0.9, "SQL": 0.75, "Spark": 0.75, "AWS": 0.65, "Docker": 0.6,
                    "System Design": 0.6
                }
            },
            "Cybersecurity Engineer": {
                description: "Protects systems, networks, and data from digital attacks and unauthorized access.",
                skills: { 
                    "APIs": 0.75, "Penetration Testing": 0.85, "Security Tools": 0.9, "Incident Response": 0.8, 
                    "Firewall": 0.75, "SIEM": 0.7, "Compliance": 0.75, "Linux": 0.85, "Networking": 0.9
                }
            },
            "Cloud Architect": {
                description: "Designs and manages complex cloud computing strategies and infrastructure.",
                skills: { 
                    "AWS": 0.99, "Azure": 0.95, "Google Cloud": 0.9, "Terraform": 0.95, "CloudFormation": 0.9, 
                    "Kubernetes": 0.85, "Docker": 0.8, "System Design": 0.95, "Networking": 0.9, "SQL": 0.85, 
                    "Security": 0.9, "Cost Optimization": 0.85, "Disaster Recovery": 0.85, "CI/CD": 0.75, 
                    "Ansible": 0.7, "Git": 0.75, "Compliance": 0.8 
                }
            },
            "Software Engineer": {
                description: "Applies engineering principles to software development, covering the full lifecycle.",
                skills: { 
                    "JavaScript": 0.96, "Git": 0.92, "APIs": 0.95, "REST": 0.93, "Testing": 0.91, 
                    "CI/CD": 0.88, "Java": 0.92, "Python": 0.97, "System Design": 0.93, "Security": 0.93, 
                    "Software Process": 0.86, "Microservices": 0.8 
                }
            }
        };

        const ALL_SKILLS = [
            ...new Set(Object.values(CAREER_DB).flatMap(c => Object.keys(c.skills)))
        ].sort();

        // --- APP CONTROLLER ---
        const app = {
            state: {
                view: 'home',
                userSkills: [],
            },

            init: function() {
                this.setupSkillAutocomplete();
                this.populateCareerSelect();
                this.navigate('home');
            },

            // Navigation Logic
            navigate: function(viewId) {
                // Hide all views
                document.querySelectorAll('[id^="view-"]').forEach(el => el.classList.add('hidden'));
                
                // Show target view
                const target = document.getElementById(`view-${viewId}`);
                if (target) {
                    target.classList.remove('hidden');
                    // Trigger animation restart
                    target.classList.remove('slide-up');
                    void target.offsetWidth; // trigger reflow
                    target.classList.add('slide-up');
                }
                this.state.view = viewId;
            },

            // --- FEATURE: SKILL TO CAREER ---
            
            setupSkillAutocomplete: function() {
                const input = document.getElementById('skillInput');
                const list = document.getElementById('skillSuggestions');

                input.addEventListener('input', (e) => {
                    const val = e.target.value.toLowerCase();
                    list.innerHTML = '';
                    if (!val) {
                        list.classList.add('hidden');
                        return;
                    }

                    const matches = ALL_SKILLS.filter(s => 
                        s.toLowerCase().includes(val) && !this.state.userSkills.includes(s)
                    );

                    if (matches.length > 0) {
                        list.classList.remove('hidden');
                        matches.forEach(skill => {
                            const div = document.createElement('div');
                            div.className = "px-4 py-2 hover:bg-slate-50 cursor-pointer text-sm text-slate-700 border-b border-slate-50 last:border-0";
                            div.textContent = skill;
                            div.onclick = () => {
                                this.addSkill(skill);
                                input.value = '';
                                list.classList.add('hidden');
                            };
                            list.appendChild(div);
                        });
                    } else {
                        list.classList.add('hidden');
                    }
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    if (!input.contains(e.target) && !list.contains(e.target)) {
                        list.classList.add('hidden');
                    }
                });
            },

            addSkill: function(skill) {
                if (!this.state.userSkills.includes(skill)) {
                    this.state.userSkills.push(skill);
                    this.renderSkillTags();
                }
            },

            removeSkill: function(skill) {
                this.state.userSkills = this.state.userSkills.filter(s => s !== skill);
                this.renderSkillTags();
            },

            renderSkillTags: function() {
                const container = document.getElementById('selectedSkillsList');
                const msg = document.getElementById('emptySkillsMsg');
                
                // Clear current tags (except msg)
                Array.from(container.children).forEach(child => {
                    if (child.id !== 'emptySkillsMsg') container.removeChild(child);
                });

                if (this.state.userSkills.length === 0) {
                    msg.classList.remove('hidden');
                } else {
                    msg.classList.add('hidden');
                    this.state.userSkills.forEach(skill => {
                        const tag = document.createElement('span');
                        tag.className = "inline-flex items-center gap-1.5 px-3 py-1 bg-teal-50 text-teal-700 border border-teal-200 rounded-full text-sm font-medium animate-fade-in";
                        tag.innerHTML = `${skill} <i class="ph-bold ph-x cursor-pointer hover:text-teal-900" onclick="app.removeSkill('${skill}')"></i>`;
                        container.appendChild(tag);
                    });
                }
            },

            calculateRecommendations: function() {
                const userSkills = this.state.userSkills;
                if (userSkills.length === 0) {
                    alert("Please add at least one skill.");
                    return;
                }

                const resultsContainer = document.getElementById('recommendationResults');
                
                // Logic: Calculate match %
                const scores = Object.entries(CAREER_DB).map(([career, data]) => {
                    let score = 0;
                    let totalWeight = 0;
                    let matchCount = 0;

                    Object.entries(data.skills).forEach(([skill, importance]) => {
                        totalWeight += importance;
                        if (userSkills.includes(skill)) {
                            score += (importance * 100);
                            matchCount++;
                        }
                    });

                    let percent = totalWeight > 0 ? (score / (totalWeight * 100)) * 100 : 0;
                    return { career, percent: Math.round(percent), matchCount, totalSkills: Object.keys(data.skills).length };
                }).sort((a, b) => b.percent - a.percent);

                // Render Results
                let html = '<div class="space-y-4">';
                scores.forEach((match, idx) => {
                    const isTop = idx === 0;
                    const colorClass = match.percent > 70 ? 'text-green-600 bg-green-500' : (match.percent > 40 ? 'text-amber-600 bg-amber-500' : 'text-slate-500 bg-slate-400');
                    const textClass = match.percent > 70 ? 'text-green-600' : (match.percent > 40 ? 'text-amber-600' : 'text-slate-500');

                    html += `
                        <div class="bg-white p-5 rounded-xl border ${isTop ? 'border-teal-400 shadow-md' : 'border-slate-200'} transition-all hover:shadow-md">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="font-bold text-slate-800 text-lg">${match.career} ${isTop ? '<span class="ml-2 text-xs bg-yellow-400 text-yellow-900 px-2 py-0.5 rounded font-bold">TOP MATCH</span>' : ''}</h3>
                                <span class="font-bold text-xl ${textClass}">${match.percent}%</span>
                            </div>
                            <div class="w-full bg-slate-100 rounded-full h-2 mb-3">
                                <div class="h-2 rounded-full ${colorClass.split(' ')[1]}" style="width: ${match.percent}%"></div>
                            </div>
                            <div class="flex justify-between text-sm text-slate-500">
                                <span>${match.matchCount} / ${match.totalSkills} skills matched</span>
                                <button onclick="app.showCareerGap('${match.career}')" class="text-teal-600 font-semibold hover:underline">View Gap Analysis</button>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                resultsContainer.innerHTML = html;
            },

            // Allow jumping from Recs to Details
            showCareerGap: function(careerName) {
                // Switch mode
                this.navigate('career-to-skill');
                // Set dropdown
                const select = document.getElementById('careerSelect');
                select.value = careerName;
                this.showCareerDetails();
            },

            // --- FEATURE: CAREER TO SKILL ---

            populateCareerSelect: function() {
                const select = document.getElementById('careerSelect');
                Object.keys(CAREER_DB).sort().forEach(career => {
                    const opt = document.createElement('option');
                    opt.value = career;
                    opt.textContent = career;
                    select.appendChild(opt);
                });
            },

            showCareerDetails: function() {
                const careerName = document.getElementById('careerSelect').value;
                if (!careerName) return;

                const data = CAREER_DB[careerName];
                const container = document.getElementById('careerDetailView');
                container.classList.remove('hidden');

                // Split skills into "Have" and "Need" based on current userSkills state (shared state)
                const skillsNeeded = [];
                const skillsHave = [];

                Object.entries(data.skills).sort(([,a], [,b]) => b - a).forEach(([skill, imp]) => {
                    if (this.state.userSkills.includes(skill)) {
                        skillsHave.push({ name: skill, imp });
                    } else {
                        skillsNeeded.push({ name: skill, imp });
                    }
                });

                // Helper to render skill card
                const renderCard = (s, type) => `
                    <div class="flex items-center justify-between p-3 rounded-lg border ${type === 'have' ? 'bg-green-50 border-green-100' : 'bg-white border-slate-100'} mb-2">
                        <div class="flex items-center gap-3">
                            <i class="${type === 'have' ? 'ph-fill ph-check-circle text-green-500' : 'ph-bold ph-book-open text-slate-400'} text-lg"></i>
                            <div>
                                <div class="font-semibold text-slate-800 text-sm">${s.name}</div>
                                <div class="text-xs text-slate-400">Importance: ${Math.round(s.imp * 100)}%</div>
                            </div>
                        </div>
                        ${type === 'need' ? '<span class="text-xs font-bold text-red-500 bg-red-50 px-2 py-1 rounded">MISSING</span>' : ''}
                    </div>
                `;

                container.innerHTML = `
                    <div class="grid md:grid-cols-2 gap-8 animate-slide-up">
                        <div>
                            <h3 class="text-lg font-bold text-slate-800 mb-4 border-b pb-2">Required Skills (${skillsNeeded.length})</h3>
                            ${skillsNeeded.length > 0 ? skillsNeeded.map(s => renderCard(s, 'need')).join('') : '<div class="p-4 bg-green-100 text-green-800 rounded-lg">You have all required skills!</div>'}
                        </div>
                        <div>
                            <h3 class="text-lg font-bold text-slate-800 mb-4 border-b pb-2">Skills You Have (${skillsHave.length})</h3>
                            ${skillsHave.length > 0 ? skillsHave.map(s => renderCard(s, 'have')).join('') : '<div class="text-slate-400 italic text-sm">Add skills to your profile to see matches here.</div>'}
                            
                            <div class="mt-6 p-4 bg-slate-50 rounded-xl border border-slate-200">
                                <h4 class="font-bold text-slate-700 text-sm mb-2">Want to update your skills?</h4>
                                <button onclick="app.navigate('skill-to-career')" class="text-sm text-indigo-600 font-semibold hover:underline">Go to Skill Editor &rarr;</button>
                            </div>
                        </div>
                    </div>
                `;
            }
        };

        // Start
        app.init();
    </script>
</body>
</html>